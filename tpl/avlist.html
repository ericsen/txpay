<!DOCTYPE html>
<html>
  <head>
  <title>main</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="/style_{COMID}/control_main.css" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="/js/fancybox/jquery.fancybox-1.3.4.css" type="text/css">
  <link rel="stylesheet" href="/js/jqueryui/jquery-ui.min.css" type="text/css">
  <link rel="stylesheet" href="/js/jqueryui/jquery-ui.structure.min.css" type="text/css">
  <link rel="stylesheet" href="/js/jqueryui/jquery-ui.theme.min.css" type="text/css">
  <script src="/js/pub_library.js" type="text/javascript"></script>
  <script src="/js/swfobject.js" type="text/javascript"></script>
  <script src="/js/js.cookie.js" type="text/javascript"></script>
  <script src="/js/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jqueryui/jquery-ui.min.js" type="text/javascript"></script>
  <script src="/js/fancybox/jquery.fancybox-1.3.4.pack.js" type="text/javascript"></script>
  <script src="/js/fancybox/jquery.easing-1.3.pack.js" type="text/javascript"></script>
  <script src="/js/fancybox/jquery.mousewheel-3.0.4.pack.js" type="text/javascript"></script>
  <script src="/js/jquery.backgroundSize.js" type="text/javascript"></script>
  <style type="text/css">

body {
  position: relative;
}

.wrap { table-layout:fixed;word-break:break-all;overflow:hidden; }

.av_list table {
  max-width: 100%;
  /*overflow-x: auto;*/
}

.av_list table tbody tr {
  height: 116px;
}

.av_list table td {
  overflow: hidden;
  padding: 4px;
  border: #000000 1px solid;
}

.av_td_outer {
  overflow-y: auto;
}

.av_list td {
  min-width: 60px;
}

.av_vfilename {
	width : 100px;
}
.av_vrdate {
  //width: 72px;
}

.av_td_outer,
.av_vimage>div, .av_td_outer,
.av_vimage1>div, .av_td_outer {
  max-height: 110px;
  line-height: 15px;
}

.av_vimage>div,
.av_vimage1>div {
  position: relative;
  width: 134px;
  height: 110px;
}

.av_vimage>div .av_vimage_img,
.av_vimage1>div .av_vimage_img {
  position: absolute;
  height: 100%;
  width: 100%;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

.av_vimage>div .av_vimage_filename .av_vimage_filename_bg,
.av_vimage1>div .av_vimage_filename .av_vimage_filename_bg {
  position: absolute;
  bottom: 0;
  background-color: #FFFFFF;
  height: 100%;
  width: 100%;
  -moz-opacity: 0.66;
  -khtml-opacity: 0.66;
  opacity: 0.66;
  -ms-filter:"progid:DXImageTransform.Microsoft.Alpha"(Opacity=66);
  filter: progid:DXImageTransform.Microsoft.Alpha(opacity=66);
  filter:alpha(opacity=66);
}

.av_vimage>div .av_vimage_filename,
.av_vimage1>div .av_vimage_filename {
  -webkit-transition: all .25s ease;
     -moz-transition: all .25s ease;
      -ms-transition: all .25s ease;
       -o-transition: all .25s ease;
          transition: all .25s ease;
}

.av_vimage>div .av_vimage_filename:hover,
.av_vimage1>div .av_vimage_filename:hover {
  -moz-opacity: 0.00;
  -khtml-opacity: 0.00;
  opacity: 0.00;
  -ms-filter:"progid:DXImageTransform.Microsoft.Alpha"(Opacity=0);
  filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0);
  filter:alpha(opacity=0);
}

.av_vimage>div .av_vimage_filename .av_vimage_filename_text,
.av_vimage1>div .av_vimage_filename .av_vimage_filename_text {
  position: absolute;
  bottom: 0;
  color: #000000;
}

.av_act input {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 46px;
}

.av_search {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: #FFFFFF;
}

.av_search table,
.av_search table table,
.av_list,
.av_list table, {
  width: 100%;
  table-layout:fixed;
}

.av_search .av_toggle_display {
  padding: 3px;
}

.av_search .av_toggle_display_item {
  float: left;
  margin-right: 4px;
  white-space: nowrap;
}

.av_search .av_toggle_display_item label,
.av_search .av_toggle_display_item input {
  vertical-align: middle;
  margin-bottom: 0px;
  margin-top: 0px;
}

/* table */
.av_list td,
.av_search td {
  vertical-align: middle;
  line-height: 12px;
  font-size: 12px;
}

  </style>
  <script language="JavaScript">
function checkAll(vid,funs){
  //檢查功能
  //funs   1:啟用 2:停用 3:刪除 4:修改
  if (funs == 1) {
    document.location = "avlist.php?act=enable&vid=" + vid;
  } else if (funs == 2) {
    document.location = "avlist.php?act=disable&vid=" + vid;
  } else if (funs == 3) {
    var ret = confirm("確定刪除影片編號 : " + vid  + " ?");
    if (ret) {  //確定刪除
        document.location = "avlist.php?act=delete&vid=" + vid;
    }
  } else if (funs == 4) {
    document.location = "addnew.php?act=edit&vid=" + vid;
  }
}

$(function () {

  function toggleField($el, isShow) {
    if (isShow) {
      $el.show();
    } else {
      $el.hide();
    }
  }

  // 將顯示隱藏資訊存在 cookies
  function saveToggleStatus() {
    var data = {};
    $('.toggle_button').each(function (index, el) {
      var key = $(el).val();
      var value = $(el).prop('checked') ? 1 : 0;
      data[key] = value;
    });
    data = JSON.stringify(data);
    Cookies.set('av_toggle', data);
  }

  // 顯示 / 隱藏
  $('.toggle_button').click(function(e) {
    var $checkbox = $(e.target);
    var classToToggle = $checkbox.val();
    var isShow = $checkbox.prop('checked');
    var $elToToggle = $('.' + classToToggle);
    toggleField($elToToggle, isShow);
    saveToggleStatus();
  });

  // 初始化 顯示 / 隱藏
  var lastToggleStat = Cookies.get('av_toggle');
  if (! lastToggleStat) {
    lastToggleStat = {
      "av_vfilename": 1,
      "av_vimage": 1,
      "av_vimage1": 0,
      "av_vtitle": 1,
      "av_vrdate": 1,
      "av_vadate": 1,
      "av_vlength": 1,
      "av_vmask": 1,
      "av_vartist": 1,
      "av_vproducer": 0,
      "av_vonum": 0,
      "av_vdesc": 1,
      "av_vdesc1": 0,
      "av_vdesc2": 0,
      "av_vstatus": 1,
      "av_vcount": 1,
      "av_tags": 1
    };
  } else {
    lastToggleStat = JSON.parse(lastToggleStat);
  }
  for (var i in lastToggleStat) {
    toggleField($('.' + i), lastToggleStat[i]);
    $('#toggle_' + i).prop('checked', lastToggleStat[i])
  }

  // 縮圖展開
  $('.av_vimage a, .av_vimage1 a').fancybox({
    "centerOnScroll": true,
    "onStart": fixFancybox,
    "onComplete": fixFancybox
  });
  function fixFancybox() {
    $('.fancybox-ie, #fancybox-overlay').css('position', 'fixed');
  }

  // 時間
  $('.datepicker').datepicker({
    dateFormat: 'yy-mm-dd'
  });

  // 複製一個 table 再最上方，提供顯示項目有換行的狀況將表格往下推
  (function () {
    var $avSearch = $('.av_search');
    var $newAvSearch = $avSearch.clone();
    $newAvSearch.css('position', 'static');
    // 避免 ID 重複
    $newAvSearch.find('.datepicker').remove();
    $newAvSearch.insertBefore($('.av_list'));
  })();

  // IE background-size contain
  $('.av_vimage>div .av_vimage_img, .av_vimage1>div .av_vimage_img')
    .css('background-size', 'contain');
  });
  </script>
  </head>

  <body>
    <table class="m_line av_list">
      <tr>
        <td>
          <table class="m_tab wrap">
            <thead>
              <tr class="m_title_bk">
                <td rowspan="2" class="av_id">ID</td>
                <td rowspan="2" class="av_vstatus">狀態</td>
                <td rowspan="2">功能</td>
                <td rowspan="2" class="">影片類型</td>
                <td rowspan="2" class="av_vfilename">影片檔名</td>
                <td rowspan="2" class="av_vimage">照片檔名</td>
                <td rowspan="2" class="av_vimage1">大照片檔名</td>
                <td rowspan="2" class="av_vtitle">片名</td>
                <td rowspan="2" class="av_vrdate">發行日</td>
                <td rowspan="2" class="av_vadate">新增時間</td>
                <td rowspan="2" class="av_vlength">片長</td>
                <td rowspan="2" class="av_vmask">碼</td>
                <td rowspan="2" class="av_vartist">演員</td>
                <td rowspan="2" class="av_vproducer">發行商</td>
                <td rowspan="2" class="av_vonum">原廠編號</td>
                <td rowspan="2" class="av_vdesc">簡介(原文)</td>
                <td rowspan="2" class="av_vdesc1">簡介(中文)</td>
                <td rowspan="2" class="av_vdesc2">簡介(英文)</td>
                <td colspan="3" class="av_vcount">觀看次數</td>
                <td rowspan="2" class="av_tags">TAG</td>
              </tr>
              <tr class="m_title_bk av_vcount">
                <td>總</td>
                <td>週</td>
                <td>月</td>
              </tr>
            </thead>
            <tbody>
              <!-- START BLOCK : Data -->
                <tr class="m_cen" onMouseOut="this.style.backgroundColor=''" onMouseOver="this.style.backgroundColor='#FFFBCC'">
                  <td class="av_id">{ID}</td>
                  <td class="av_vstatus">{vstatus}</td>
                  <td class="">{vsubtype}</td>
                  <td class="av_act">
                    <input type=button name=act value="啟用" onclick="checkAll({ID},1);">
                    <input type=button name=act value="停用" onclick="checkAll({ID},2);">
                    <input type=button name=act value="刪除" onclick="checkAll({ID},3);">
                    <input type=button name=act value="修改" onclick="checkAll({ID},4);">
                  </td>
                  <td class="av_vtitle">
                    <div class="av_td_outer">
                      <div class="av_td_inner">{vtitle}</div>
                    </div>
                  </td>
                  <td class="av_vfilename">{vfilename}</td>
                  <td class="av_vimage">
                    <div>
                      <a href="{VPHOTO}" target="_blank" border=0>
                        <div class="av_vimage_img" style="background-image: url('{VPHOTO}?v={DATE}');"></div>
                        <div class="av_vimage_filename">
                          <div class="av_vimage_filename_bg"></div>
                          <div class="av_vimage_filename_text">{vimage}</div>
                        </div>
                      </a>
                    </div>
                  </td>
                  <td class="av_vimage1">
                    <div>
                      <a href="/VIDEOS/photo/{vimage1}" target="_blank" border=0>
                        <div class="av_vimage_img" style="background-image: url('/VIDEOS/photo/{vimage1}');"></div>
                        <div class="av_vimage_filename">
                          <div class="av_vimage_filename_bg"></div>
                          <div class="av_vimage_filename_text">{vimage1}</div>
                        </div>
                      </a>
                    </div>
                  </td>
                  <td class="av_vrdate">{vrdate}</td>
                  <td class="av_vadate">{vadate}</td>
                  <td class="av_vlength">{vlength}</td>
                  <td class="av_vmask">{vmask}</td>
                  <td class="av_vartist">
                    <div class="av_td_outer">
                      <div class="av_td_inner">{vartist}</div>
                    </div>
                  </td>
                  <td class="av_vproducer">{vproducer}</td>
                  <td class="av_vonum">{vonum}</td>
                  <td class="av_vdesc">
                    <div class="av_td_outer">
                      <div class="av_td_inner">{vdesc}</div>
                    </div>
                  </td>
                  <td class="av_vdesc1">
                    <div class="av_td_outer">
                      <div class="av_td_inner">{vdesc1}</div>
                    </div>
                  </td>
                  <td class="av_vdesc2">
                    <div class="av_td_outer">
                      <div class="av_td_inner">{vdesc2}</div>
                    </div>
                  </td>
                  <td class="av_vcount">{vcount0}</td>
                  <td class="av_vcount">{vcount1}</td>
                  <td class="av_vcount">{vcount2}</td>
                  <td class="av_tags">{TAGS}</td>
                </tr>
              <!-- END BLOCK : Data -->
              <!-- START BLOCK : NoData -->
                <tr class="m_cen">
                  <td id="nodata_td">
                    <font color="#ff0000">{_NoData}</font>
                    <script>
                      // 移除欄位名稱
                      $(function () {
                        $('.av_list table thead').remove();
                      });
                    </script>
                  </td>
                </tr>
              <!-- END BLOCK : NoData -->
            </tbody>
          </table>
        </td>
      </tr>
    </table>
    <div class="av_search" >
      <form name="mForm" method="get">
        <table width="100%">
          <tr>
            <td class="m_tline">
              <table>
                <tr>
                  <td width="100"> &nbsp; 影片列表</td>
                  <td width="238">
                    <span>搜尋日期 : </span>
                    <label for="sdate">從</label>
                    <input id="sdate" class="datepicker" name="sdate" style="width: 70px;" value="{sdate}">
                    <label for="edate">到</label>
                    <input id="edate" class="datepicker" name="edate" style="width: 70px;" value="{edate}">
                  </td>
                  <td>
                    <span>關鍵字 : </span>
                    <input type=text name="keyword" value="{keyword}">
                    <input type=submit name=submit1 value="搜尋">
                    <input type=submit name=submit1 value="搜尋ID"></td>
                  <td width=30></td>
                  <td>{_AllPage} : {_Di}<select name="page" onChange="this.form.submit()" class="za_select">{PAGE_OPTION}</select> / {PAGE_TOTAL} {_Page}</td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <td class="av_toggle_display">
              <div class="av_toggle_display_item">
                <input id="toggle_av_vserver" type="checkbox" class="toggle_button" value="av_vserver" checked="checked">
                <label for="toggle_av_vserver">影片主機</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vfilename" type="checkbox" class="toggle_button" value="av_vfilename" checked="checked">
                <label for="toggle_av_vfilename">影片檔名</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vimage" type="checkbox" class="toggle_button" value="av_vimage" checked="checked">
                <label for="toggle_av_vimage">照片檔名</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vimage1" type="checkbox" class="toggle_button" value="av_vimage1" checked="checked">
                <label for="toggle_av_vimage1">大照片檔名</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vtitle" type="checkbox" class="toggle_button" value="av_vtitle" checked="checked">
                <label for="toggle_av_vtitle">片名</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vrdate" type="checkbox" class="toggle_button" value="av_vrdate" checked="checked">
                <label for="toggle_av_vrdate">發行日</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vadate" type="checkbox" class="toggle_button" value="av_vadate" checked="checked">
                <label for="toggle_av_vadate">新增時間</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vlength" type="checkbox" class="toggle_button" value="av_vlength" checked="checked">
                <label for="toggle_av_vlength">片長</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vmask" type="checkbox" class="toggle_button" value="av_vmask" checked="checked">
                <label for="toggle_av_vmask">碼</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vartist" type="checkbox" class="toggle_button" value="av_vartist" checked="checked">
                <label for="toggle_av_vartist">演員</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vproducer" type="checkbox" class="toggle_button" value="av_vproducer" checked="checked">
                <label for="toggle_av_vproducer">發行商</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vonum" type="checkbox" class="toggle_button" value="av_vonum" checked="checked">
                <label for="toggle_av_vonum">原廠編號</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vdesc" type="checkbox" class="toggle_button" value="av_vdesc" checked="checked">
                <label for="toggle_av_vdesc">簡介(原文)</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vdesc1" type="checkbox" class="toggle_button" value="av_vdesc1" checked="checked">
                <label for="toggle_av_vdesc1">簡介(中文)</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vdesc2" type="checkbox" class="toggle_button" value="av_vdesc2" checked="checked">
                <label for="toggle_av_vdesc2">簡介(英文)</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vstatus" type="checkbox" class="toggle_button" value="av_vstatus" checked="checked">
                <label for="toggle_av_vstatus">狀態</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_vcount" type="checkbox" class="toggle_button" value="av_vcount" checked="checked">
                <label for="toggle_av_vcount">觀看次數</label>
              </div>
              <div class="av_toggle_display_item">
                <input id="toggle_av_tags" type="checkbox" class="toggle_button" value="av_tags" checked="checked">
                <label for="toggle_av_tags">TAG</label>
              </div>
            </td>
          </tr>
        </table>
      </form>
    </div>
  </body>
</html>
